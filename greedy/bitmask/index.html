<!--
  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
--> <!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Welcome to 5lipet's Note. This is a shelf for competitive programing note."><meta name=author content=5lipet><link href=https://localhost:8000/greedy/bitmask/ rel=canonical><link href=../greedy/ rel=prev><link href=../../string/kmp/ rel=next><link rel=icon href=../../assets/logo.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>Bitmask - 5lipet</title><link rel=stylesheet href=../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><style>:root{.md-tag.md-tag--default-tag{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M32.5%2096v149.5c0%2017%206.7%2033.3%2018.7%2045.3l192%20192c25%2025%2065.5%2025%2090.5%200l149.5-149.5c25-25%2025-65.5%200-90.5l-192-192C279.2%2038.7%20263%2032%20246%2032H96.5c-35.3%200-64%2028.7-64%2064m112%2016a32%2032%200%201%201%200%2064%2032%2032%200%201%201%200-64%22/%3E%3C/svg%3E');}.md-tag.md-tag--hardware-tag{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M176%2024c0-13.3-10.7-24-24-24s-24%2010.7-24%2024v40c-35.3%200-64%2028.7-64%2064H24c-13.3%200-24%2010.7-24%2024s10.7%2024%2024%2024h40v56H24c-13.3%200-24%2010.7-24%2024s10.7%2024%2024%2024h40v56H24c-13.3%200-24%2010.7-24%2024s10.7%2024%2024%2024h40c0%2035.3%2028.7%2064%2064%2064v40c0%2013.3%2010.7%2024%2024%2024s24-10.7%2024-24v-40h56v40c0%2013.3%2010.7%2024%2024%2024s24-10.7%2024-24v-40h56v40c0%2013.3%2010.7%2024%2024%2024s24-10.7%2024-24v-40c35.3%200%2064-28.7%2064-64h40c13.3%200%2024-10.7%2024-24s-10.7-24-24-24h-40v-56h40c13.3%200%2024-10.7%2024-24s-10.7-24-24-24h-40v-56h40c13.3%200%2024-10.7%2024-24s-10.7-24-24-24h-40c0-35.3-28.7-64-64-64V24c0-13.3-10.7-24-24-24s-24%2010.7-24%2024v40h-56V24c0-13.3-10.7-24-24-24s-24%2010.7-24%2024v40h-56zm-16%20104h192c17.7%200%2032%2014.3%2032%2032v192c0%2017.7-14.3%2032-32%2032H160c-17.7%200-32-14.3-32-32V160c0-17.7%2014.3-32%2032-32m16%2048v160h160V176z%22/%3E%3C/svg%3E');}.md-tag.md-tag--software-tag{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20640%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M64%2096c0-35.3%2028.7-64%2064-64h384c35.3%200%2064%2028.7%2064%2064v240h-64V96H128v240H64zM0%20403.2C0%20392.6%208.6%20384%2019.2%20384h601.6c10.6%200%2019.2%208.6%2019.2%2019.2%200%2042.4-34.4%2076.8-76.8%2076.8H76.8C34.4%20480%200%20445.6%200%20403.2M281%20209l-31%2031%2031%2031c9.4%209.4%209.4%2024.6%200%2033.9s-24.6%209.4-33.9%200l-48-48c-9.4-9.4-9.4-24.6%200-33.9l48-48c9.4-9.4%2024.6-9.4%2033.9%200s9.4%2024.6%200%2033.9zm112-34%2048%2048c9.4%209.4%209.4%2024.6%200%2033.9l-48%2048c-9.4%209.4-24.6%209.4-33.9%200s-9.4-24.6%200-33.9l31-31-31-31c-9.4-9.4-9.4-24.6%200-33.9s24.6-9.4%2033.9%200z%22/%3E%3C/svg%3E');}}</style><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><!-- Extra style sheets (can't be set in mkdocs.yml due to content hash) --><link rel=stylesheet href=../../assets/stylesheets/custom.css></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#bit-by-bit-greedy class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=5lipet class="md-header__button md-logo" aria-label=5lipet data-md-component=logo> <img src=../../assets/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> 5lipet </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Bitmask </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=indigo aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 256 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l137.3-137.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/slipet/5lipet.git/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> slipet/5lipet </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> HOME </a> </li> <li class=md-tabs__item> <a href=../../review/review/ class=md-tabs__link> Review </a> </li> <li class=md-tabs__item> <a href=../../stat/leetcode/ class=md-tabs__link> Stat </a> </li> <li class=md-tabs__item> <a href=../../ds/seg_tree/ class=md-tabs__link> Data Structure </a> </li> <li class=md-tabs__item> <a href=../../search/dfs/ class=md-tabs__link> Search </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../greedy/ class=md-tabs__link> Greedy </a> </li> <li class=md-tabs__item> <a href=../../string/kmp/ class=md-tabs__link> String </a> </li> <li class=md-tabs__item> <a href=../../dp/digits_counting/ class=md-tabs__link> DP </a> </li> <li class=md-tabs__item> <a href=../../math/number_theory/ class=md-tabs__link> Math </a> </li> <li class=md-tabs__item> <a href=../../conclusion/conclusion/ class=md-tabs__link> Conclusion </a> </li> <li class=md-tabs__item> <a href=../../CSES/Introductory_Problems/ class=md-tabs__link> CSES </a> </li> <li class=md-tabs__item> <a href=../../problems/leetcode/ class=md-tabs__link> Problems </a> </li> <li class=md-tabs__item> <a href=../../contest/codeforces/2025_S4/ class=md-tabs__link> Contest </a> </li> <li class=md-tabs__item> <a href=../../cpp/function/ class=md-tabs__link> CPP </a> </li> <li class=md-tabs__item> <a href=../../todo/list/ class=md-tabs__link> To-do list </a> </li> <li class=md-tabs__item> <a href=../../resources/list/ class=md-tabs__link> Resources </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=5lipet class="md-nav__button md-logo" aria-label=5lipet data-md-component=logo> <img src=../../assets/logo.png alt=logo> </a> 5lipet </label> <div class=md-nav__source> <a href=https://github.com/slipet/5lipet.git/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> slipet/5lipet </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_1> <div class="md-nav__link md-nav__container"> <a href=../.. class="md-nav__link "> <span class=md-ellipsis> HOME </span> </a> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> HOME </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Review </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Review </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../review/review/ class=md-nav__link> <span class=md-ellipsis> Review </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Stat </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Stat </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../stat/leetcode/ class=md-nav__link> <span class=md-ellipsis> Leetcode </span> </a> </li> <li class=md-nav__item> <a href=../../stat/codeforces/ class=md-nav__link> <span class=md-ellipsis> Codeforces </span> </a> </li> <li class=md-nav__item> <a href=../../stat/mixed/ class=md-nav__link> <span class=md-ellipsis> Mixed </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Data Structure </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Data Structure </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ds/seg_tree/ class=md-nav__link> <span class=md-ellipsis> Segment Tree </span> </a> </li> <li class=md-nav__item> <a href=../../ds/union_find/ class=md-nav__link> <span class=md-ellipsis> Union-Find/Disjoint Set </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Search </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Search </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../search/dfs/ class=md-nav__link> <span class=md-ellipsis> DFS </span> </a> </li> <li class=md-nav__item> <a href=../../search/bfs/ class=md-nav__link> <span class=md-ellipsis> BFS </span> </a> </li> <li class=md-nav__item> <a href=../../search/meet_in_middle/ class=md-nav__link> <span class=md-ellipsis> Meet in middle </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6 checked> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex> <span class=md-ellipsis> Greedy </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=true> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Greedy </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../greedy/ class=md-nav__link> <span class=md-ellipsis> Greedy </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Bitmask </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Bitmask </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> 試填法 </span> </a> <nav class=md-nav aria-label=試填法> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> 增量計算 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#other class=md-nav__link> <span class=md-ellipsis> Other </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> String </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> String </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../string/kmp/ class=md-nav__link> <span class=md-ellipsis> KMP </span> </a> </li> <li class=md-nav__item> <a href=../../string/z_algorithm/ class=md-nav__link> <span class=md-ellipsis> Z-algorithm </span> </a> </li> <li class=md-nav__item> <a href=../../string/subseq_automation/ class=md-nav__link> <span class=md-ellipsis> Subseq automation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0> <span class=md-ellipsis> DP </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> DP </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../dp/digits_counting/ class=md-nav__link> <span class=md-ellipsis> Digits counting </span> </a> </li> <li class=md-nav__item> <a href=../../dp/matrix_exponentiation/ class=md-nav__link> <span class=md-ellipsis> Matrix Exponentiation </span> </a> </li> <li class=md-nav__item> <a href=../../dp/convex_hull_trick/ class=md-nav__link> <span class=md-ellipsis> Convex Hull Trick </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_9> <label class=md-nav__link for=__nav_9 id=__nav_9_label tabindex=0> <span class=md-ellipsis> Math </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=false> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Math </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../math/number_theory/ class=md-nav__link> <span class=md-ellipsis> Number theory </span> </a> </li> <li class=md-nav__item> <a href=../../math/order_theory/ class=md-nav__link> <span class=md-ellipsis> Order theory </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_10> <label class=md-nav__link for=__nav_10 id=__nav_10_label tabindex=0> <span class=md-ellipsis> Conclusion </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_10_label aria-expanded=false> <label class=md-nav__title for=__nav_10> <span class="md-nav__icon md-icon"></span> Conclusion </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../conclusion/conclusion/ class=md-nav__link> <span class=md-ellipsis> Conclusion </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_11> <label class=md-nav__link for=__nav_11 id=__nav_11_label tabindex=0> <span class=md-ellipsis> CSES </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_11_label aria-expanded=false> <label class=md-nav__title for=__nav_11> <span class="md-nav__icon md-icon"></span> CSES </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../CSES/Introductory_Problems/ class=md-nav__link> <span class=md-ellipsis> Introductory Problems </span> </a> </li> <li class=md-nav__item> <a href=../../CSES/Sorting_and_Searching/ class=md-nav__link> <span class=md-ellipsis> Sorting and Searching </span> </a> </li> <li class=md-nav__item> <a href=../../CSES/Dynamic_Programming/ class=md-nav__link> <span class=md-ellipsis> Dynamic Programming </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_12> <label class=md-nav__link for=__nav_12 id=__nav_12_label tabindex=0> <span class=md-ellipsis> Problems </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_12_label aria-expanded=false> <label class=md-nav__title for=__nav_12> <span class="md-nav__icon md-icon"></span> Problems </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../problems/leetcode/ class=md-nav__link> <span class=md-ellipsis> Leetcode </span> </a> </li> <li class=md-nav__item> <a href=../../problems/codeforces/ class=md-nav__link> <span class=md-ellipsis> Codeforces </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_13> <label class=md-nav__link for=__nav_13 id=__nav_13_label tabindex=0> <span class=md-ellipsis> Contest </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_13_label aria-expanded=false> <label class=md-nav__title for=__nav_13> <span class="md-nav__icon md-icon"></span> Contest </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_13_1> <label class=md-nav__link for=__nav_13_1 id=__nav_13_1_label tabindex=0> <span class=md-ellipsis> Codeforces </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_13_1_label aria-expanded=false> <label class=md-nav__title for=__nav_13_1> <span class="md-nav__icon md-icon"></span> Codeforces </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_13_1_1> <label class=md-nav__link for=__nav_13_1_1 id=__nav_13_1_1_label tabindex=0> <span class=md-ellipsis> 2025 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_13_1_1_label aria-expanded=false> <label class=md-nav__title for=__nav_13_1_1> <span class="md-nav__icon md-icon"></span> 2025 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../contest/codeforces/2025_S4/ class=md-nav__link> <span class=md-ellipsis> S4 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_13_1_2> <label class=md-nav__link for=__nav_13_1_2 id=__nav_13_1_2_label tabindex=0> <span class=md-ellipsis> 2026 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_13_1_2_label aria-expanded=false> <label class=md-nav__title for=__nav_13_1_2> <span class="md-nav__icon md-icon"></span> 2026 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../contest/codeforces/2026_S1/ class=md-nav__link> <span class=md-ellipsis> S1 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_13_2> <label class=md-nav__link for=__nav_13_2 id=__nav_13_2_label tabindex=0> <span class=md-ellipsis> Leetcode </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_13_2_label aria-expanded=false> <label class=md-nav__title for=__nav_13_2> <span class="md-nav__icon md-icon"></span> Leetcode </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_13_2_1> <label class=md-nav__link for=__nav_13_2_1 id=__nav_13_2_1_label tabindex=0> <span class=md-ellipsis> 2025 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_13_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_13_2_1> <span class="md-nav__icon md-icon"></span> 2025 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../contest/leetcode/2025_S4/ class=md-nav__link> <span class=md-ellipsis> S4 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_13_2_2> <label class=md-nav__link for=__nav_13_2_2 id=__nav_13_2_2_label tabindex=0> <span class=md-ellipsis> 2026 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_13_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_13_2_2> <span class="md-nav__icon md-icon"></span> 2026 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../contest/leetcode/2026_S1/ class=md-nav__link> <span class=md-ellipsis> S1 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_14> <label class=md-nav__link for=__nav_14 id=__nav_14_label tabindex=0> <span class=md-ellipsis> CPP </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_14_label aria-expanded=false> <label class=md-nav__title for=__nav_14> <span class="md-nav__icon md-icon"></span> CPP </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cpp/function/ class=md-nav__link> <span class=md-ellipsis> CPP </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_15> <label class=md-nav__link for=__nav_15 id=__nav_15_label tabindex=0> <span class=md-ellipsis> To-do list </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_15_label aria-expanded=false> <label class=md-nav__title for=__nav_15> <span class="md-nav__icon md-icon"></span> To-do list </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../todo/list/ class=md-nav__link> <span class=md-ellipsis> To-do </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_16> <label class=md-nav__link for=__nav_16 id=__nav_16_label tabindex=0> <span class=md-ellipsis> Resources </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_16_label aria-expanded=false> <label class=md-nav__title for=__nav_16> <span class="md-nav__icon md-icon"></span> Resources </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../resources/list/ class=md-nav__link> <span class=md-ellipsis> Resources </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> 試填法 </span> </a> <nav class=md-nav aria-label=試填法> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> 增量計算 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#other class=md-nav__link> <span class=md-ellipsis> Other </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <nav class=md-path aria-label=Navigation> <ol class=md-path__list> <li class=md-path__item> <a href=../.. class=md-path__link> <span class=md-ellipsis> Welcome to MkDocs </span> </a> </li> <li class=md-path__item> <a href=../greedy/ class=md-path__link> <span class=md-ellipsis> Greedy </span> </a> </li> </ol> </nav> <article class="md-content__inner md-typeset"> <h1 id=bit-by-bit-greedy>Bit-by-bit greedy<a class=headerlink href=#bit-by-bit-greedy title="Permanent link">&para;</a></h1> <h2 id=_1>試填法<a class=headerlink href=#_1 title="Permanent link">&para;</a></h2> <p>可以透過<span style=color:red>整數的連續性</span>將試填法分成兩種做法:</p> <ul> <li>假設 i-th 為 1/0 則，能否有符合限制的前綴。</li> </ul> <div class="language-cpp highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=k>for</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>hi</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=o>--</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=w>    </span><span class=n>mask</span><span class=w> </span><span class=o>|=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>nxt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ans</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>i</span><span class=p>);</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=w>    </span><span class=k>for</span><span class=p>(</span><span class=k>auto</span><span class=w> </span><span class=p>...)</span><span class=w> </span><span class=p>{</span><span class=c1>//traverse element to meet the requirments</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=w>        </span><span class=n>res</span><span class=w>  </span><span class=p>[</span><span class=n>op</span><span class=o>=</span><span class=p>]</span><span class=w> </span><span class=p>(</span><span class=n>x</span><span class=w> </span><span class=o>&amp;</span><span class=w> </span><span class=n>mask</span><span class=p>);</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=w>        </span><span class=k>if</span><span class=p>(</span><span class=n>check</span><span class=w> </span><span class=p>...)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=w>            </span><span class=n>ans</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>nxt</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=w>            </span><span class=p>...</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=w>        </span><span class=p>...</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=p>}</span>
</span></code></pre></div> <ol> <li> <p><a href=https://leetcode.cn/problems/maximum-xor-of-two-numbers-in-an-array/ >421. 数组中两个数的最大异或值</a></p> <p>題目要求找出最大 <span class=arithmatex>\(x \oplus y\)</span>，透過維護前綴 mask 以及在 i-th 位元試填 nxt，使用 hash table 找出是否有 <span class=arithmatex>\(nxt \oplus x_{pre_i}\)</span>，若有表示 i-th 可以填 1。</p> </li> <li> <p><a href=https://leetcode.com/problems/maximum-strong-pair-xor-ii/description/ >2935. Maximum Strong Pair XOR II</a></p> <p>題目要求找出符合限制的 <span class=arithmatex>\(x \oplus y\)</span>，透過維護前綴 mask 以及在 i-th 位元試填 nxt，使用 hash table 找到能否有符合題目要求的 <span class=arithmatex>\(nxt \oplus x_{pre_i}\)</span>，若有表示 i-th 可以填 1。</p> </li> <li> <p><a href=https://leetcode.cn/problems/minimize-or-of-remaining-elements-using-operations/description/ >3022. 给定操作次数内使剩余元素的或值最小</a></p> <p>這題乍看之下要使用下面的方法做逐位排除確定，但是從 [7,3,15,14,2,8] 這個例子會發現這樣沒辦法得到解答，可以發現若是題目把可以操作的元素限制在一個集合當中，並且要透過維護一些性質並計算出答案，就要使用類似上面的模板的思考方向。</p> <p>這題是要求限制 k 次 AND 操作後集合中的元素進行 OR 所得最小，透過維護前綴 mask 確定那些位元會是 0 得到當前操作 <span class=arithmatex>\(\le k\)</span> 次的解。</p> </li> <li> <p><a href=https://slipet.github.io/5lipet/contest/leetcode/2026_S1/#weekly-contest-484>3806. 增加操作后最大按位与的结果</a></p> <p>貢獻法 + 試填法。構造出 target 需要多少貢獻，選最小貢獻的 m 做 AND。</p> </li> <li> <p>Codeforces:</p> <ol> <li> <p><a href=https://slipet.github.io/5lipet/contest/codeforces/2025_S4/#c-xor-factorization>XOR-factorization</a></p> <p>直覺的貪心會掉進陷阱，必須逐位元維護那些數是沿著 limit n，那些數是小於 n。</p> </li> </ol> </li> </ol> <p>核心想法:</p> <p>若是題目把可以操作的元素限制在一個<span style=color:red>有限集合</span>(大小大概是 <span class=arithmatex>\(10^5\)</span> )當中。透過維護前綴 mask 每次都只取 x 前綴，在遍歷過程中維護題目要求，重點在於遍歷的過程中要滿足限制。</p> <p>有些題目可以使用 0-1 Trie 完成。</p> <hr> <ul> <li> <p>k-th lexicographical binary string</p> <ul> <li> <p>對於每一位，假設這一位是 0/1，計算後面還能構成多少合法字串，如果 <span class=arithmatex>\(\ge k\)</span>，就選 0，否則選 1 並扣掉數量。</p> </li> <li> <p>或者假設這一位是 1，計算左邊和右邊可以產生多少貢獻 x x x 1 o o .. ，如果 <span class=arithmatex>\(\le k\)</span> 那就把這位設為 1 並扣掉貢獻。</p> </li> <li> <p>核心想法: <span style=color:red>利用整數的連續性</span>，不斷縮小規模從而確定答案。</p> </li> </ul> </li> <li> <p><a href=https://leetcode.cn/problems/maximum-number-that-sum-of-the-prices-is-less-than-or-equal-to-k/description/ >3007. 价值和小于等于 K 的最大数字</a></p> <p>計算 i-th 設 1 會產生出的貢獻，若是小於 k ，減去貢獻並縮小規模，貢獻的公式 <span class=arithmatex>\(cnt = pre_i \times 2^i + \lfloor \frac{i}{x} \rfloor \times 2^{i - 1}\)</span>，直觀理解為右邊有 <span class=arithmatex>\(2^i\)</span> 的方案數可以使左邊 <span class=arithmatex>\(pre_i\)</span> 產生貢獻。對於右邊的情況則可以用組合數學的方式思考，在 [0, i - 1] 位元上共有 <span class=arithmatex>\(\lfloor \frac{i}{x} \rfloor\)</span> 個是可以產生貢獻的位元，對於每個位元其可以產生的貢獻為 <span class=arithmatex>\(2^{i - 1}\)</span>，<span class=arithmatex>\(2^{i - 1}\)</span> 代表著除了自己之外的方案數，兩個相乘 <span class=arithmatex>\(\lfloor \frac{i}{x} \rfloor \times 2^{i - 1}\)</span> 表示在 x 位置上可以產生的貢獻。</p> </li> <li> <p><a href=https://leetcode.cn/problems/find-products-of-elements-of-big-array/description/ >3145. 大数组元素的乘积</a></p> <p>這題跟上面那題的思路是一樣的，只有在細節上不一樣，因為題目限制只有 2 的冪次相乘，所以可以將相乘的計算改為冪次和的計算，避免數值溢出。另外對於右邊的冪次和 <span class=arithmatex>\(\sum_{0}^{x = i - 1} x * 2^{i - 1}\)</span>，所以可以利用等差級數和公式得到 <span class=arithmatex>\(\frac{i(i - 1)}{2} \times 2^{i - 1}\)</span>。</p> </li> <li> <p><a href=https://slipet.github.io/5lipet/contest/leetcode/2026_S1/#weekly-contest-486>3821. 二进制中恰好K个1的第N小整数</a></p> <p>由高位至低位透過假設 i-th bit 填 0 的方案數決定這個位元是否填 1</p> </li> <li> <p><a href=https://leetcode.cn/problems/maximum-sized-array/description/ >3344. 最大尺寸数组</a></p> <p>這題要計算的是 $<span class=arithmatex>\(\sum_{j, k}(j \text{ OR } k) = \sum_{j, k} \sum_m(j \text{ OR } k) \text{ AND } 2^m = \sum_m \sum_{j, k} (j \text{ AND } 2^m) \text{ OR } (k \text{ AND } 2^m)\)</span>$</p> <p>由於 <span class=arithmatex>\(j \text{ AND } 2^m\)</span> 只會是 <span class=arithmatex>\(2^m\)</span> 或是 0，所以可以轉化為 <span class=arithmatex>\(n^2 - cnt^2(j \text{ AND } 2^m = 0)\)</span>，用全部可能 <span class=arithmatex>\(n^2\)</span> 減去兩側皆為 0 的情況:</p> <div class=arithmatex>\[\sum_{j, k} \sum_m(j \text{ AND } 2^m) \text{ OR } (k \text{ AND } 2^m) = \sum_{j, k} \sum_m 2^m(n^2 - Card^2\{j | j \text{AND} 2^m = 0\})\]</div> <p>設函數 <span class=arithmatex>\(Z(n, m) = Card\{j | 0 \le j &lt; n, j \text{AND} 2^m = 0\}\)</span> 為 <span class=arithmatex>\([0, n - 1]\)</span> 的數中第 m 位為 0 的個數。</p> <div class=arithmatex>\[\sum_{j, k} \sum_m(j \text{ AND } 2^m) \text{ OR } (k \text{ AND } 2^m) = \sum_m 2^m(n^2 - Z^2(n, m))\]</div> <p>可以發現 0, 1 在 [0, n - 1] 中是週期性出現的，所以 Z(n, m) 可以利用這個性質很容易的求出，我們可以利用二分的方式得到 <span class=arithmatex>\(O(\log^2{n})\)</span> 的方法。</p> <p>可以發現我們要計算的整數範圍是 [0, n - 1]，由整數的連續性可以知道可以透過逐位確定不斷縮小問題規模。</p> <hr> <h3 id=_2>增量計算<a class=headerlink href=#_2 title="Permanent link">&para;</a></h3> <p><a href=https://leetcode.cn/problems/maximum-sized-array/solutions/3703073/bi-er-fen-geng-kuai-de-olog-nzhu-wei-que-95sq/ >講解</a></p> <p>要使用逐位確定的話必須求出在第 i 位產生的貢獻，假設 <span class=arithmatex>\(n = a \cdot 2^b\)</span>， <span class=arithmatex>\(n\)</span> 是二進制右邊皆為 0 的形式。</p> <p>有 <span class=arithmatex>\(G(n) = \sum_{0\le j, k &lt; n}(j \text { OR } k) = \sum_m 2^m(n^2 - Z^2(n, m))\)</span></p> <p>我們想要計算的是對於 <span class=arithmatex>\(2^{b-1}\)</span> 產生的增量，也就是 <span class=arithmatex>\(G(n + 2^{b-1}) - G(n)\)</span>，當我們由高至低確定第 b - 1 位是否會超過限制 s ，若是不超過則 <span class=arithmatex>\(n = n + 2^{b-1}\)</span> 不斷逼近 s。</p> <p>由上面的 <span class=arithmatex>\(G(n)\)</span> 可以知道，<span class=arithmatex>\(G(n + 2^{b-1}) = \sum_{m}2^m((n+2^{b-1})^2 - Z^2(n+2^{b-1},m))\)</span>，此時需要關注的點是 <span class=arithmatex>\(Z(n+2^{b-1},m)\)</span>，要考慮的是 <span class=arithmatex>\(Z(n+2^{b-1},m)\)</span> 與 <span class=arithmatex>\(Z(n+2,m)\)</span> 的關係變化。</p> <p>我們要考慮的是四種情況:</p> <p>1) <span class=arithmatex>\(0 \le m &lt; b - 1\)</span></p> <p>由二進制的週期性可以知道 <span class=arithmatex>\(Z(n + 2^{b-1}, m) = \frac{n + 2^{b-1}}{2}\)</span></p> <p>此時產生的增量為</p> <div class=arithmatex>\[ \begin{aligned} G(n + 2^{b-1}) - G(n) &amp;= \sum_m 2^m((n+2^{b-1})^2 - Z^2(n+2^{b-1}, m)) - \sum_m 2^m(n^2 - Z^2(n, m)) \\ &amp;= \sum_m 2^m((n+2^{b-1})^2 - Z^2(n+2^{b-1}, m) - n^2 + Z^2(n,m)) \\ &amp;= \sum_m 2^m((n+2^{b-1})^2 - (\frac{n + 2^{b-1}}{2})^2 - n^2 + (\frac{n}{2})^2) \\ &amp;= \frac{3}{4} \sum_m 2^m((n+2^{b-1})^2 - n^2) \\ &amp;= \frac{3}{4} \cdot (2^{b-1} - 1) \cdot ((n+2^{b-1})^2 - n^2) \\ &amp;= \frac{3}{4} \cdot (2^{b-1} - 1) \cdot 2^{b-1}(2 \cdot n + 2^{b-1}) \\ \end{aligned} \]</div> <p>可以利用等比級數和公式將式子化簡 <span class=arithmatex>\(\sum_{m = 0}^{b - 2} 2^m = (2^{b-1} - 1)\)</span> </p> <p>2) <span class=arithmatex>\(m = b - 1\)</span></p> <p>3) <span class=arithmatex>\(m \ge b, (n \text{ AND } 2^m) = 0\)</span></p> <p>4) <span class=arithmatex>\(m \ge b, (n \text{ AND } 2^m) = 2^m\)</span></p> </li> </ul> <h2 id=other>Other<a class=headerlink href=#other title="Permanent link">&para;</a></h2> <ul> <li> <p>Codeforces:</p> <ol> <li> <p><a href=https://slipet.github.io/5lipet/problems/codeforces/#2146d2-max-sum-or-hard-version>Max Sum OR (Easy Version)/(Hard Version)</a></p> <p>觀察到對於 <span class=arithmatex>\([2^h, r]\)</span> 的位元表示跟　<span class=arithmatex>\([l, 2^h - 1]\)</span> 是互補的，因此可以用這個方式進行配對。</p> </li> </ol> </li> </ul> <p>need to practice:</p> <p>leetcode 3106. 满足距离约束且字典序最小的字符串 leetcode 3720. 大于目标字符串的最小字典序排列 leetcode 3734. 大于目标字符串的最小字典序回文排列 leetcode 3470. 全排列 IV leetcode 3022. 给定操作次数内使剩余元素的或值最小 leetcode 3518. 最小回文排列 II</p> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../greedy/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Greedy"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 256 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l137.3-137.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Greedy </div> </div> </a> <a href=../../string/kmp/ class="md-footer__link md-footer__link--next" aria-label="Next: KMP"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> KMP </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 256 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M247.1 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L179.2 256 41.9 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2025 ~ now | 🚀 5lipet </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["content.code.annotate", "content.code.copy", "content.tooltips", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.path", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": {"Default": "default-tag", "Hardware": "hardware-tag", "Software": "software-tag"}, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.79ae519e.min.js></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <!-- Extra JavaScript (can't be set in mkdocs.yml due to content hash) --> <script src=../../assets/javascripts/custom.js></script> </body> </html>